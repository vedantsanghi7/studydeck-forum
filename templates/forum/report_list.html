{% extends 'base.html' %}

{% block title %}Reports - StudyDeck Forum{% endblock %}

{% block content %}
<h2>Reports</h2>
<div class="table-responsive">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Reporter</th>
                <th>Content</th>
                <th>Reason</th>
                <th>Status</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for report in reports %}
            <tr>
                <td>{{ report.reporter.get_full_name|default:report.reporter.username }}</td>
                <td>
                    {% if report.thread %}
                    <a href="{% url 'forum:thread_detail' report.thread.pk %}">{{ report.thread.title }}</a>
                    {% else %}
                    <a href="{% url 'forum:thread_detail' report.reply.thread.pk %}">Reply in {{ report.reply.thread.title }}</a>
                    {% endif %}
                </td>
                <td>{{ report.reason|truncatewords:10 }}</td>
                <td>
                    {% if report.status == 'Pending' %}
                    <span class="badge bg-warning">{{ report.status }}</span>
                    {% else %}
                    <span class="badge bg-success">{{ report.status }}</span>
                    {% endif %}
                </td>
                <td>{{ report.created_at|timesince }} ago</td>
                <td>
                    {% if report.status == 'Pending' %}
                    <a href="{% url 'forum:report_resolve' report.pk %}" class="btn btn-sm btn-success">Resolve</a>
                    {% else %}
                    Resolved by {{ report.resolved_by.get_full_name|default:report.resolved_by.username }}
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center text-muted">No reports found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
